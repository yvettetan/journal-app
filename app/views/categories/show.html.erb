<section class='main-section'>
  <%= link_to 'Back to categories', categories_path, class: 'btn btn-outline-dark' %>
  <div class="container d-flex justify-content-between align-items-center flex-wrap mt-4">
    <div>
      <h1 class='fs-3'><%= @category.title.humanize %></h1>
      <p class='fs-6 text-muted'><%= @category.description.humanize %></p>
    </div>
    <%= link_to(edit_category_path(@category)) do %>
      <button class='btn btn-warning btn-sm text-white'>
        <i class="far fa-edit"></i>
        Edit Category
      </button>
    <% end %>
  </div>
  <hr>
  <div class='container'>
    <div class="d-flex justify-content-between align-items-center flex-wrap">
      <h1 class='fs-5'>List of Tasks</h1>
      <%= link_to(new_category_task_path(@category)) do %>
        <button class='btn btn-secondary btn-sm'>
          <i class="fas fa-plus"></i>
          New Task
        </button>
      <% end %>
    </div>
    <table class="table table-striped mb-4">
      <thead>
        <tr class="table-header">
          <th>Name</th>
          <th>Description</th>
          <th>Due Date</th>
          <th colspan="3" class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @category.tasks.order(due_at: :asc).each do |task| %>
          <% if task.persisted? %> <%# to only display tasks saved in the database %>
            <tr>
              <td><%= task.name.humanize %></td>
              <td><%= truncate(task.description.humanize, length: 60) %></td>
              <td><%= task.due_at.strftime("%b %d, %Y") %></td>
              <td class='text-center'><%= link_to "", [task.category, task], class:'fas fa-eye text-primary' %></td>
              <td class='text-center'><%= link_to "", edit_category_task_path(task.category, task), class:'far fa-edit text-warning' %></td>
              <td class='text-center'><%= link_to "", category_task_path(task.category, task),
              class:'far fa-trash-alt text-danger',
              method: :delete,
              data: { confirm: "Are you sure you want to delete #{task.name}?" } %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
</section>
